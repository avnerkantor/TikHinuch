}
surveyPlotFunction("ISR", "Male", "Medium", "IC01Q01")
surveyPlotFunction<-function(country, Gender, ESCS, variable){
switch (ESCS,
High = {
c1<-student2012%>%filter(CNT==country, is.na(ST04Q01 == Gender), ESCS>"0.7")%>%count_(variable)
},
Medium={
c1<-student2012%>%filter(CNT==country, is.na(ST04Q01 == Gender), ESCS<="0.7", ESCS>="0.2")%>%count_(variable)
},
Low={
c1<-student2012%>%filter(CNT==country, is.na(ST04Q01 == Gender), ESCS<"0.2")%>%count_(variable)
}
)
c2<-collect(c1)
c2%>%mutate(freq = round(100 * n/sum(n), 1))
}
surveyPlotFunction("ISR", "Male", "Medium", "IC01Q01")
f<-na
f<-NA
is.na(f)
f<-"Asdf"
is.na(f)
surveyPlotFunction<-function(country, Gender, ESCS, variable){
switch (ESCS,
High = {
c1<-student2012%>%filter(CNT==country, ifelse(!is.na(Gender), ST04Q01 == Gender), ESCS>"0.7")%>%count_(variable)
},
Medium={
c1<-student2012%>%filter(CNT==country, ifelse(!is.na(Gender), ST04Q01 == Gender), ESCS<="0.7", ESCS>="0.2")%>%count_(variable)
},
Low={
c1<-student2012%>%filter(CNT==country, ifelse(!is.na(Gender), ST04Q01 == Gender), ESCS<"0.2")%>%count_(variable)
}
)
c2<-collect(c1)
c2%>%mutate(freq = round(100 * n/sum(n), 1))
}
surveyPlotFunction("ISR", "Male", "Medium", "IC01Q01")
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
Countries<-read.csv("data/countries.csv", header = TRUE, sep=",")
Countries%>%
filter(Hebrew=="ישראל")%>%select(CNT)
as.vector(unlist(Countries%>%
filter(Hebrew=="ישראל")%>%select(CNT)))
runApp()
a<-"asdf"
a
nrow(a)
ncol(a)
length(a)
length(a)==1
length(a)==2
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
c1<-Student2012%>%filter(CNT=="ISR", ST04Q01=="Female")%>%count_("IC01Q05")
pisadb<-src_bigquery("r-shiny-1141", "pisa")
Student2012<- tbl(pisadb, "student2012")
c1<-Student2012%>%filter(CNT=="ISR", ST04Q01=="Female")%>%count_("IC01Q05")
c2<-collect(c1)
c3<-c2%>%mutate(freq = round(100 * n/sum(n), 1))%>%rename_(var=SurveySelectedID)
c3<-c2%>%mutate(freq = round(100 * n/sum(n), 1))%>%rename_(var="IC01Q05")
View(c3)
c1a<-Student2012%>%filter(CNT=="ISR")%>%count(IC01Q05, ST04Q01)
c2a<-collect(c1a)
View(c2a)
by_tailnum <- group_by(c2a, ST04Q01)
View(by_tailnum)
by_tailnum <- group_by(c2a, ST04Q01)%>%mutate(freq = round(100 * n/sum(n), 1))
View(by_tailnum)
c3a<-c2a%>%group_by(ST04Q01)%>%mutate(freq = round(100 * n/sum(n), 1))%>%rename_(var="IC01Q05")
View(c3a)
ggplot(data=c3a, aes(x=var, y=freq, colour=ST04Q01)) +
geom_bar(position="dodge",stat="identity", fill="#b276b2") +
coord_flip() +
labs(title="", y="" ,x= "") +
#scale_y_discrete(breaks=c(0, 100))
theme_bw() +
theme(
panel.border = element_blank(),
panel.grid.major=element_blank(),
axis.ticks = element_blank(),
panel.grid.minor = element_blank() )
ggplot(data=c3a, aes(x=var, y=freq, colour=ST04Q01)) +
geom_bar(position="dodge",stat="identity") +
coord_flip() +
labs(title="", y="" ,x= "") +
#scale_y_discrete(breaks=c(0, 100))
theme_bw() +
theme(
panel.border = element_blank(),
panel.grid.major=element_blank(),
axis.ticks = element_blank(),
panel.grid.minor = element_blank() )
ggplot(data=c3a, aes(x=var, y=freq, group=ST04Q01)) +
geom_bar(position="dodge",stat="identity") +
coord_flip() +
labs(title="", y="" ,x= "") +
#scale_y_discrete(breaks=c(0, 100))
theme_bw() +
theme(
panel.border = element_blank(),
panel.grid.major=element_blank(),
axis.ticks = element_blank(),
panel.grid.minor = element_blank() )
ggplot(data=c3a, aes(x=var, y=freq, group=ST04Q01)) +
geom_bar(position="dodge",stat="identity") +
coord_flip() +
labs(title="", y="" ,x= "") +
#scale_y_discrete(breaks=c(0, 100))
theme_bw() +
theme(
panel.border = element_blank(),
panel.grid.major=element_blank(),
axis.ticks = element_blank(),
panel.grid.minor = element_blank() )
ggplot(data=c3a, aes(x=var, y=freq, group=ST04Q01)) +
geom_bar(position="dodge",stat="identity") +
coord_flip() +
labs(title="", y="" ,x= "") +
#scale_y_discrete(breaks=c(0, 100))
theme_bw() +
facet_grid(,~ST04Q01)
theme(
panel.border = element_blank(),
panel.grid.major=element_blank(),
axis.ticks = element_blank(),
panel.grid.minor = element_blank() )
ggplot(data=c3a, aes(x=var, y=freq, group=ST04Q01)) +
geom_bar(position="dodge",stat="identity") +
coord_flip() +
labs(title="", y="" ,x= "") +
#scale_y_discrete(breaks=c(0, 100))
theme_bw() +
facet_grid(,~ST04Q01)
ggplot(data=c3a, aes(x=var, y=freq, group=ST04Q01)) +
geom_bar(position="dodge",stat="identity") +
coord_flip() +
labs(title="", y="" ,x= "") +
#scale_y_discrete(breaks=c(0, 100))
theme_bw() +
facet_grid(. ~ST04Q01)
ggplot(data=c3, aes(x=var, y=freq, group=ST04Q01)) +
geom_bar(position="dodge",stat="identity") +
coord_flip() +
labs(title="", y="" ,x= "") +
#scale_y_discrete(breaks=c(0, 100))
theme_bw() +
facet_grid(. ~ST04Q01)
ggplot(data=c3a, aes(x=var, y=freq, group=ST04Q01)) +
geom_bar(position="dodge",stat="identity") +
coord_flip() +
labs(title="", y="" ,x= "") +
#scale_y_discrete(breaks=c(0, 100))
theme_bw() +
facet_grid(. ~ST04Q01)
library(ggplot2)
library(bigrquery)
library(dplyr)
pisadb<-src_bigquery("r-shiny-1141", "pisa")
Student2012<- tbl(pisadb, "student2012")
c1<-Student2012%>%filter(CNT=="ISR", ST04Q01=="Female")%>%count_("IC01Q05")
c2<-collect(c1)
c3<-c2%>%mutate(freq = round(100 * n/sum(n), 1))%>%rename_(var="IC01Q05")
c1a<-Student2012%>%filter(CNT=="ISR")%>%count(IC01Q05, ST04Q01)
c2a<-collect(c1a)
c3a<-c2a%>%group_by(ST04Q01)%>%mutate(freq = round(100 * n/sum(n), 1))%>%rename_(var="IC01Q05")
View(c3a)
View(c2)
c3<-c2%>%mutate(freq = round(100 * n/sum(n), 1), General)%>%rename_(var="IC01Q05")
c3<-c2%>%mutate(freq = round(100 * n/sum(n), 1), General="General")%>%rename_(var="IC01Q05")
View(c3)
c3<-c2%>%mutate(freq = round(100 * n/sum(n), 1), Group="General")%>%rename_(var="IC01Q05")
View(c3)
c3a<-c2a%>%group_by(Group=ST04Q01)%>%mutate(freq = round(100 * n/sum(n), 1))%>%rename_(var="IC01Q05")
View(c3a)
View(c2a)
c1a<-Student2012%>%filter(CNT=="ISR")%>%count(IC01Q05, Group=ST04Q01)
c2a<-collect(c1a)
View(c2a)
c3a<-c2a%>%group_by(ST04Q01)%>%mutate(freq = round(100 * n/sum(n), 1))%>%rename_(var="IC01Q05", group="ST04Q01")
View(c3a)
c1a<-Student2012%>%filter(CNT=="ISR")%>%count(IC01Q05, ST04Q01)
pisadb<-src_bigquery("r-shiny-1141", "pisa")
Student2012<- tbl(pisadb, "student2012")
c1a<-Student2012%>%filter(CNT=="ISR")%>%count(IC01Q05, ST04Q01)
c2a<-collect(c1a)
c3a<-c2a%>%group_by(ST04Q01)%>%mutate(freq = round(100 * n/sum(n), 1))%>%rename_(answer="IC01Q05", group="ST04Q01")
View(c3a)
c1<-Student2012%>%filter(CNT=="ISR")%>%count_("IC01Q05")
c2<-collect(c1)
View(c2)
c3<-c2%>%mutate(freq = round(100 * n/sum(n), 1), group="General")%>%rename_(answer="IC01Q05")
View(c3)
c1b<-Student2012%>%filter(CNT=="ISR", ESCS>"0.7")%>%count_("IC01Q05")
c2b<-collect(c1)
c3b<-c2%>%mutate(freq = round(100 * n/sum(n), 1), group="High")%>%rename_(answer="IC01Q05")
View(c3b)
c1c<-Student2012%>%filter(CNT=="ISR",  ESCS<="0.7", ESCS>="0.2")%>%count_("IC01Q05")
c2c<-collect(c1)
c3c<-c2%>%mutate(freq = round(100 * n/sum(n), 1), group="Medium")%>%rename_(answer="IC01Q05")
View(c3c)
c1b<-Student2012%>%filter(CNT=="ISR", ESCS>0.7)%>%count_("IC01Q05")
c2b<-collect(c1)
c3b<-c2%>%mutate(freq = round(100 * n/sum(n), 1), group="High")%>%rename_(answer="IC01Q05")
View(c3b)
c1b<-Student2012%>%filter(CNT=="ISR", ESCS>0.7)%>%count(IC01Q05)
c2b<-collect(c1)
c3b<-c2%>%mutate(freq = round(100 * n/sum(n), 1), group="High")%>%rename_(answer="IC01Q05")
View(c3b)
View(c3)
View(c3b)
View(c3a)
d<-Student2012%>%select(ESCS)
head(d)
summary(d)
d<-Student2012%>%summary(ESCS)
d
e<-Student2012%>%filter(CNT=="ISR", ESCS>0.7)
head(e)
e<-Student2012%>%filter(CNT=="ISR", ESCS>"0.7")
head(e)
d<-Student2012%>%select(ESCS)%>%filter(ESCS>"0.7")
head(d)
c1b<-Student2012%>%filter(CNT=="ISR")%>%select(IC01Q05, ESCS)%>%filter(ESCS>"0.7")%>%count(IC01Q05)
c2b<-collect(c1)
View(c2b)
c3b<-c2%>%mutate(freq = round(100 * n/sum(n), 1), group="High")%>%rename_(answer="IC01Q05")
View(c3b)
m<-Student2012%>%filter(CNT=="ISR")%>%select(IC01Q05, ESCS)%>%filter(ESCS<"0.7")%>%count(IC01Q05)
m<-collect(m)
m<-m%>%mutate(freq = round(100 * n/sum(n), 1), group="High")%>%rename_(answer="IC01Q05")
View(m)
pisadb<-src_bigquery("r-shiny-1141", "pisa")
Student2012<- tbl(pisadb, "student2012")
#General
a<-Student2012%>%filter(CNT=="ISR")%>%count_("IC01Q05")
a<-collect(a)
a<-a%>%mutate(freq = round(100 * n/sum(n), 1), group="General")%>%rename_(answer="IC01Q05")
b<-Student2012%>%filter(CNT=="ISR")%>%count(IC01Q05, ST04Q01)
b<-collect(b)
b<-b%>%group_by(ST04Q01)%>%mutate(freq = round(100 * n/sum(n), 1))%>%rename_(answer="IC01Q05", group="ST04Q01")
c1<-Student2012%>%filter(CNT=="ISR")%>%filter(ESCS>"0.7")%>%count(IC01Q05)
c1<-collect(c1)
c1<-c1%>%mutate(freq = round(100 * n/sum(n), 1), group="High")%>%rename_(answer="IC01Q05")
c2<-Student2012%>%filter(CNT=="ISR",  ESCS<="0.7", ESCS>="0.2")%>%count_("IC01Q05")
c2<-collect(c1)
c2<-c2%>%mutate(freq = round(100 * n/sum(n), 1), group="Medium")%>%rename_(answer="IC01Q05")
c3<-Student2012%>%filter(CNT=="ISR",  ESCS<"0.2")%>%count_("IC01Q05")
c3<-collect(c3)
c3<-c3%>%mutate(freq = round(100 * n/sum(n), 1), group="Low")%>%rename_(answer="IC01Q05")
View(a)
View(b)
View(c1)
View(c2)
View(c3)
c2<-Student2012%>%filter(CNT=="ISR",  ESCS<="0.7", ESCS>="0.2")%>%count(IC01Q05)
c2<-collect(c1)
c2<-c2%>%mutate(freq = round(100 * n/sum(n), 1), group="Medium")%>%rename_(answer="IC01Q05")
View(c2)
View(c1)
c1<-Student2012%>%filter(CNT=="ISR", ESCS>"0.7")%>%count(IC01Q05)
c1<-collect(c1)
c1<-c1%>%mutate(freq = round(100 * n/sum(n), 1), group="High")%>%rename_(answer="IC01Q05")
View(c1)
b<-Student2012%>%filter(CNT=="ISR")%>%count(IC01Q05, ST04Q01)
b<-collect(b)
b<-b%>%group_by(ST04Q01)%>%mutate(freq = round(100 * n/sum(n), 1), group="ST04Q01")%>%rename_(answer="IC01Q05")
View(b)
b<-Student2012%>%filter(CNT=="ISR")%>%count(IC01Q05, ST04Q01)
b<-collect(b)
b<-b%>%group_by(ST04Q01)%>%mutate(freq = round(100 * n/sum(n), 1))%>%rename_(group="ST04Q01", answer="IC01Q05")
View(b)
b<-Student2012%>%filter(CNT=="ISR")%>%count(IC01Q05, ST04Q01)
b<-collect(b)
b<-b%>%group_by(ST04Q01)%>%mutate(freq = round(100 * n/sum(n), 1))%>%rename_(answer="IC01Q05", group="ST04Q01")
View(b)
a<-a%>%mutate(freq = round(100 * n/sum(n), 1), group="General")%>%rename_(answer="IC01Q05")
b<-Student2012%>%filter(CNT=="ISR")%>%count(IC01Q05, ST04Q01)
b<-collect(b)
b<-b%>%group_by(ST04Q01)%>%mutate(freq = round(100 * n/sum(n), 1))%>%rename_(answer="IC01Q05", group="ST04Q01")%>%select(answer, n, freq, group)
View(b)
d<-bind_rows(a, b, c1, c2, c3)
View(d)
c2<-Student2012%>%filter(CNT=="ISR",  ESCS<="0.7", ESCS>="0.2")%>%count(IC01Q05)
c2<-collect(c1)
c2<-c2%>%mutate(freq = round(100 * n/sum(n), 1), group="Medium")%>%rename_(answer="IC01Q05")
View(c2)
c2<-Student2012%>%filter(CNT=="ISR",  ESCS<="0.7", ESCS>="0.2")%>%count(IC01Q05)
c2<-collect(c2)
c2<-c2%>%mutate(freq = round(100 * n/sum(n), 1), group="Medium")%>%rename_(answer="IC01Q05")
d<-bind_rows(a, b, c1, c2, c3)
View(c2)
View(d)
shiny::runApp()
#General
General<-Student2012%>%filter(CNT=="ISR")%>%count_("IC01Q05")
General<-collect(General)
General<-General%>%mutate(freq = round(100 * n/sum(n), 1), group="General")%>%rename_(answer="IC01Q05")
#Gender
Gender<-Student2012%>%filter(CNT=="ISR")%>%count(IC01Q05, ST04Q01)
Gender<-collect(Gender)
Gender<-Gender%>%group_by(ST04Q01)%>%mutate(freq = round(100 * n/sum(n), 1))%>%rename_(answer="IC01Q05", group="ST04Q01")%>%select(answer, n, freq, group)
#ESCS
High<-Student2012%>%filter(CNT=="ISR", ESCS>"0.7")%>%count(IC01Q05)
High<-collect(High)
High<-High%>%mutate(freq = round(100 * n/sum(n), 1), group="High")%>%rename_(answer="IC01Q05")
Medium<-Student2012%>%filter(CNT=="ISR",  ESCS<="0.7", ESCS>="0.2")%>%count(IC01Q05)
Medium<-collect(Medium)
Medium<-Medium%>%mutate(freq = round(100 * n/sum(n), 1), group="Medium")%>%rename_(answer="IC01Q05")
Low<-Student2012%>%filter(CNT=="ISR",  ESCS<"0.2")%>%count_("IC01Q05")
Low<-collect(Low)
Low<-Low%>%mutate(freq = round(100 * n/sum(n), 1), group="Low")%>%rename_(answer="IC01Q05")
surveyTable<-bind_rows(General, Gender, High, Medium, Low)
View(surveyTable)
High<-Student2012%>%filter(CNT=="ISR", ESCS>"0.7")%>%count_("IC01Q05")
High<-collect(High)
High<-High%>%mutate(freq = round(100 * n/sum(n), 1), group="High")%>%rename_(answer="IC01Q05")
Medium<-Student2012%>%filter(CNT=="ISR",  ESCS<="0.7", ESCS>="0.2")%>%count_("IC01Q05")
Medium<-collect(Medium)
Medium<-Medium%>%mutate(freq = round(100 * n/sum(n), 1), group="Medium")%>%rename_(answer="IC01Q05")
View(High)
View(Medium)
View(surveyTable)
runApp()
runApp()
runApp()
View(surveyTable)
runApp()
runApp()
runApp()
runApp()
#General
General<-Student2012%>%filter(CNT=="ISR")%>%count_("IC01Q05")
General<-collect(General)
General<-General%>%mutate(freq = round(100 * n/sum(n), 1), group="General")%>%rename_(answer="IC01Q05")
#Gender
Gender<-Student2012%>%filter(CNT=="ISR")%>%count(IC01Q05, ST04Q01)
Gender<-collect(Gender)
Gender<-Gender%>%group_by(ST04Q01)%>%mutate(freq = round(100 * n/sum(n), 1))%>%rename_(answer="IC01Q05", group="ST04Q01")%>%select(answer, n, freq, group)
#ESCS
High<-Student2012%>%filter(CNT=="ISR", ESCS>"0.7")%>%count_("IC01Q05")
High<-collect(High)
High<-High%>%mutate(freq = round(100 * n/sum(n), 1), group="High")%>%rename_(answer="IC01Q05")
Medium<-Student2012%>%filter(CNT=="ISR",  ESCS<="0.7", ESCS>="0.2")%>%count_("IC01Q05")
Medium<-collect(Medium)
Medium<-Medium%>%mutate(freq = round(100 * n/sum(n), 1), group="Medium")%>%rename_(answer="IC01Q05")
Low<-Student2012%>%filter(CNT=="ISR",  ESCS<"0.2")%>%count_("IC01Q05")
Low<-collect(Low)
Low<-Low%>%mutate(freq = round(100 * n/sum(n), 1), group="Low")%>%rename_(answer="IC01Q05")
surveyTable<-bind_rows(General, Gender, High, Medium, Low)
Male<-Student2012%>%filter(CNT=="ISR", ST04Q01=="Male")%>%count_("IC01Q05")
Male<-collect(Male)
Male<-Male%>%mutate(freq = round(100 * n/sum(n), 1), group="Male")%>%rename_(answer="IC01Q05")
Female<-Student2012%>%filter(CNT=="ISR", ST04Q01=="Female")%>%count_("IC01Q05")
Female<-collect(Female)
Female<-Female%>%mutate(freq = round(100 * n/sum(n), 1), group="Female")%>%rename_(answer="IC01Q05")
#ESCS
High<-Student2012%>%filter(CNT=="ISR", ESCS>"0.7")%>%count_("IC01Q05")
High<-collect(High)
High<-High%>%mutate(freq = round(100 * n/sum(n), 1), group="High")%>%rename_(answer="IC01Q05")
Medium<-Student2012%>%filter(CNT=="ISR",  ESCS<="0.7", ESCS>="0.2")%>%count_("IC01Q05")
Medium<-collect(Medium)
Medium<-Medium%>%mutate(freq = round(100 * n/sum(n), 1), group="Medium")%>%rename_(answer="IC01Q05")
Low<-Student2012%>%filter(CNT=="ISR",  ESCS<"0.2")%>%count_("IC01Q05")
Low<-collect(Low)
Low<-Low%>%mutate(freq = round(100 * n/sum(n), 1), group="Low")%>%rename_(answer="IC01Q05")
surveyTable<-bind_rows(General, Male, Female, High, Medium, Low)
#General
General<-Student2012%>%filter(CNT=="ISR")%>%count_("IC01Q05")
General<-collect(General)
General<-General%>%mutate(freq = round(100 * n/sum(n), 1), group="General")%>%rename_(answer="IC01Q05")
#Gender
Male<-Student2012%>%filter(CNT=="ISR", ST04Q01=="Male")%>%count_("IC01Q05")
Male<-collect(Male)
Male<-Male%>%mutate(freq = round(100 * n/sum(n), 1), group="Male")%>%rename_(answer="IC01Q05")
Female<-Student2012%>%filter(CNT=="ISR", ST04Q01=="Female")%>%count_("IC01Q05")
Female<-collect(Female)
Female<-Female%>%mutate(freq = round(100 * n/sum(n), 1), group="Female")%>%rename_(answer="IC01Q05")
#ESCS
High<-Student2012%>%filter(CNT=="ISR", ESCS>"0.7")%>%count_("IC01Q05")
High<-collect(High)
High<-High%>%mutate(freq = round(100 * n/sum(n), 1), group="High")%>%rename_(answer="IC01Q05")
Medium<-Student2012%>%filter(CNT=="ISR",  ESCS<="0.7", ESCS>="0.2")%>%count_("IC01Q05")
Medium<-collect(Medium)
Medium<-Medium%>%mutate(freq = round(100 * n/sum(n), 1), group="Medium")%>%rename_(answer="IC01Q05")
Low<-Student2012%>%filter(CNT=="ISR",  ESCS<"0.2")%>%count_("IC01Q05")
Low<-collect(Low)
Low<-Low%>%mutate(freq = round(100 * n/sum(n), 1), group="Low")%>%rename_(answer="IC01Q05")
surveyTable<-bind_rows(General, Male, Female, High, Medium, Low)
General<-Student2012%>%filter(CNT=="ISR")%>%count_("IC01Q05")
adb<-src_bigquery("r-shiny-1141", "pisa")
Stud
library(ggplot2)
library(bigrquery)
library(dplyr)
pisadb<-src_bigquery("r-shiny-1141", "pisa")
Student2012<- tbl(pisadb, "student2012")
General<-Student2012%>%filter(CNT=="ISR")%>%count_("IC01Q05")
General<-collect(General)
General<-collect(General)
library(bigrquery)
library(dplyr)
pisadb<-src_bigquery("r-shiny-1141", "pisa")
Student2012<- tbl(pisadb, "student2012")
General<-Student2012%>%filter(CNT=="ISR")%>%count_("IC01Q05")
General<-collect(General)
View(General)
General<-General%>%mutate(freq = round(100 * n/sum(n), 1), group="General")%>%rename_(answer="IC01Q05")
Male<-Student2012%>%filter(CNT=="ISR", ST04Q01=="Male")%>%count_("IC01Q05")
Male<-collect(Male)
Male<-Male%>%mutate(freq = round(100 * n/sum(n), 1), group="Male")%>%rename_(answer="IC01Q05")
Female<-Student2012%>%filter(CNT=="ISR", ST04Q01=="Female")%>%count_("IC01Q05")
Female<-collect(Female)
Female<-Female%>%mutate(freq = round(100 * n/sum(n), 1), group="Female")%>%rename_(answer="IC01Q05")
#ESCS
High<-Student2012%>%filter(CNT=="ISR", ESCS>"0.7")%>%count_("IC01Q05")
High<-collect(High)
High<-High%>%mutate(freq = round(100 * n/sum(n), 1), group="High")%>%rename_(answer="IC01Q05")
Medium<-Student2012%>%filter(CNT=="ISR",  ESCS<="0.7", ESCS>="0.2")%>%count_("IC01Q05")
Medium<-collect(Medium)
Medium<-Medium%>%mutate(freq = round(100 * n/sum(n), 1), group="Medium")%>%rename_(answer="IC01Q05")
Low<-Student2012%>%filter(CNT=="ISR",  ESCS<"0.2")%>%count_("IC01Q05")
Low<-collect(Low)
Low<-Low%>%mutate(freq = round(100 * n/sum(n), 1), group="Low")%>%rename_(answer="IC01Q05")
surveyTable<-bind_rows(General, Male, Female, High, Medium, Low)
setwd("~/R/tikhinuch4")
save(surveyTable, file="surveyTable.rda")
View(surveyTable)
surveyData2<- surveyTable %>% filter(group=="General")
View(surveyData2)
surveyData2<- surveyTable %>% filter(group=="General")
library(ggplot2)
ggplot(data=c3a, aes(x=var, y=freq, fill=group)) +
geom_bar(position="dodge",stat="identity") +
coord_flip() +
labs(title="", y="" ,x= "") +
#scale_y_discrete(breaks=c(0, 100))
theme_bw() +
facet_grid(. ~ST04Q01)
ggplot(data=surveyData2, aes(x=answer, y=freq, fill=group)) +
geom_bar(position="dodge",stat="identity") +
coord_flip() +
labs(title="", y="" ,x= "") +
#scale_y_discrete(breaks=c(0, 100))
theme_bw() +
facet_grid(. ~group)
surveyData1<- surveyTable %>%
filter(group %in% c("Male", "Female"))
View(surveyData1)
ggplot(data=surveyData1, aes(x=answer, y=freq, fill=group)) +
geom_bar(position="dodge",stat="identity") +
coord_flip() +
labs(title="", y="" ,x= "") +
#scale_y_discrete(breaks=c(0, 100))
theme_bw() +
facet_grid(. ~group)
surveyData3<- surveyTable %>%
filter(group %in% c("High", "Medium", "Low"))
ggplot(data=surveyData3, aes(x=answer, y=freq, fill=group)) +
geom_bar(position="dodge",stat="identity") +
coord_flip() +
labs(title="", y="" ,x= "") +
#scale_y_discrete(breaks=c(0, 100))
theme_bw() +
facet_grid(. ~group)
shiny::runApp()
runApp()
library(broom)
data(Orange)
dim(Orange)
View(Orange)
cor(Orange$age, Orange$circumference)
library(ggplot2)
ggplot(Orange, aes(age, circumference, color = Tree)) + geom_line()
Orange %>% group_by(Tree) %>% summarize(correlation = cor(age, circumference))
General<-Student2012%>%filter(CNT=="ISR")%>%select_("PV1MATH", "WEALTH")
library(ggplot2)
library(bigrquery)
library(dplyr)
pisadb<-src_bigquery("r-shiny-1141", "pisa")
Student2012<- tbl(pisadb, "student2012")
General<-Student2012%>%filter(CNT=="ISR")%>%select_("PV1MATH", "WEALTH")
General<-collect(General)
View(General)
lm(General)
summarise(General)
summary(General)
lm(General$PV1MATH ~ General$WEALTH)
cor(General$PV1MATH, General$WEALTH, use="complete.obs", method="pearson")
fit<-lm(PV1MATH~WEALTH, data=General)
summary(fit)
View(summary(fit))
coefficients(fit)
library(Hmisc)
describe(General)
library(pastecs)
install.packages("pastecs")
library(pastecs)
stat.desc(General)
install.packages("psych")
install.packages("psych")
shiny::runApp()
shiny::runApp()
